<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Apex Horizontal Overlay</title>

<style>
:root{
  --bg: rgba(10,26,59,0.78);
  --accent: #FFC928;
  --white: #fff;
  --muted: rgba(255,255,255,0.85);
  --radius: 20px;
  --h: 80px;
}

/* Body is transparent for Streamlabs */
body{
  margin:0;
  background:transparent;
  font-family: "Montserrat", sans-serif;
}

/* Main bar container */
.bar{
  width: 100%;
  height: var(--h);
  background: var(--bg);
  border-radius: var(--radius);
  display: flex;
  align-items: center;
  padding: 0 20px;
  box-sizing: border-box;
  gap: 30px;
  backdrop-filter: blur(5px);
  border:2px solid rgba(255,255,255,0.1);
}

/* Left block: Team + Score */
.left{
  display:flex;
  align-items:center;
  gap:18px;
}
.team{
  font-size:26px;
  font-weight:800;
  color:var(--accent);
  letter-spacing:1px;
}
.score{
  font-size:34px;
  font-weight:900;
  color:var(--white);
}
.overs{
  font-size:18px;
  font-weight:700;
  color:var(--muted);
}

/* Center block: THIS OVER */
.center{
  display:flex;
  align-items:center;
  gap:10px;
}
.label{
  font-size:18px;
  font-weight:700;
  color:var(--muted);
}
.ball{
  width:36px;
  height:36px;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:20px;
  font-weight:800;
  border:2px solid var(--accent);
  color:var(--white);
}
.zero{ border-color:rgba(255,255,255,0.2); color:rgba(255,255,255,0.6); }
.run4{ background:var(--accent); color:var(--bg); }
.run6{ background:var(--accent); color:var(--bg); }
.wicket{ background:#B71C1C; border-color:#8A1515; }

/* Right block: batsmen & bowler */
.right{
  display:flex;
  align-items:center;
  gap:18px;
}

.bat{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:18px;
  color:var(--white);
  font-weight:700;
}
.dot{
  width:14px;
  height:14px;
  border-radius:50%;
  background:var(--accent);
}
.dot.off{
  background:transparent;
  border:2px solid var(--accent);
}

.bowler{
  font-size:16px;
  color:var(--muted);
  font-weight:700;
}
</style>
</head>

<body>

<div class="bar">

  <!-- LEFT BLOCK -->
  <div class="left">
    <div class="team" id="teamName">APX</div>
    <div class="score" id="scoreBig">0/0</div>
    <div class="overs" id="oversSmall">0.0 ov</div>
  </div>

  <!-- CENTER BLOCK -->
  <div class="center">
    <div class="label">THIS OVER</div>
    <div class="ball zero" id="b1">-</div>
    <div class="ball zero" id="b2">-</div>
    <div class="ball zero" id="b3">-</div>
    <div class="ball zero" id="b4">-</div>
    <div class="ball zero" id="b5">-</div>
    <div class="ball zero" id="b6">-</div>
  </div>

  <!-- RIGHT BLOCK -->
  <div class="right">

    <div class="bat">
      <div class="dot" id="s1dot"></div>
      <span id="p1name">P1</span>
      <span id="p1stats">0(0)</span>
    </div>

    <div class="bat">
      <div class="dot off" id="s2dot"></div>
      <span id="p2name">P2</span>
      <span id="p2stats">0(0)</span>
    </div>

    <div class="bowler" id="bowlerFigures">Bowler 0.0-0-0</div>

  </div>
</div>

<script>

/* Your Apps Script URL already inserted */
const CONFIG = {
  feedUrl: "https://script.google.com/macros/s/AKfycbw_RRTNhUeFIzDgsu5pVCUT0wNko-C9ejjKWTM25tQYcUO-Qa9M1yFORmA_yTvd2K91Nw/exec",
  refreshMs: 1200,
  jsonpCallbackName: "apexLTCallback"
};

/* JSONP loader */
function loadJSONP(){
  const s = document.createElement("script");
  s.src = CONFIG.feedUrl + "?callback=" + CONFIG.jsonpCallbackName + "&_=" + Date.now();
  document.body.appendChild(s);
  s.onload = () => { document.body.removeChild(s); };
}

/* JSONP callback */
function apexLTCallback(data){
  if(!data) return;

  document.getElementById("teamName").textContent = data.team || "TEAM";
  document.getElementById("scoreBig").textContent = data.score || "0/0";
  document.getElementById("oversSmall").textContent = (data.overs || "0.0") + " ov";

  const p1 = data.batsmen?.[0] || {name:"-",runs:0,balls:0,striker:false};
  const p2 = data.batsmen?.[1] || {name:"-",runs:0,balls:0,striker:false};

  document.getElementById("p1name").textContent = p1.name;
  document.getElementById("p1stats").textContent = `${p1.runs}(${p1.balls})`;
  document.getElementById("p2name").textContent = p2.name;
  document.getElementById("p2stats").textContent = `${p2.runs}(${p2.balls})`;

  document.getElementById("s1dot").classList.toggle("off", !p1.striker);
  document.getElementById("s2dot").classList.toggle("off", !p2.striker);

  if(data.bowler){
    document.getElementById("bowlerFigures").textContent =
      `${data.bowler.name} ${data.bowler.overs}-${data.bowler.runs}-${data.bowler.wickets}`;
  }

  const lb = data.lastBalls || [];
  const arr = Array(6 - lb.length).fill("-").concat(lb);
  for(let i=0;i<6;i++){
    const el = document.getElementById("b"+(i+1));
    const v = arr[i];
    el.textContent = v;
    el.className = "ball";

    if(v==="W") el.classList.add("wicket");
    else if(v==="4") el.classList.add("run4");
    else if(v==="6") el.classList.add("run6");
    else if(String(v).startsWith("+")){
      el.style.background="#444"; el.style.color="#fff";
    }
    else el.classList.add("zero");
  }
}

function loop(){
  loadJSONP();
  setTimeout(loop, CONFIG.refreshMs);
}
loop();

</script>
</body>
</html>
